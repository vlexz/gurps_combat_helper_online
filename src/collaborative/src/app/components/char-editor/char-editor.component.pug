mixin statblock(caption, name, stat, readonly)
  tr
    td: b=caption
    td
      if (!readonly)
        if(stat)
          app-stat-block([statName]="\'" + name + "\'", [stat]= 'current.stats.' + name, (statChanged)='statChanged($event)')
        else
          input.cost(type='number', [(ngModel)]='current.' + name, (change)='cpChanged($event)')
      else
        if stat 
          span= '{{current.stats.' + name + '}}'
        else
          span= '{{current.' + name + '}}'
    if(stat)    
      td= '{{current.stats.' + name + '.cp}}' 



mixin mainInfo 
  table
    tr
    td Name 
      input(type="text", name='name', [(ngModel)]='current.name', (change)='mainInfoChanged($event)')
    td Player
      input(type="text", name='player', [(ngModel)]='current.player', (change)='mainInfoChanged($event)')

mixin mainVariables
  table
    tr
      td
        img(src='/assets/default_portrait.png', (click)='uploadPortrait()')
        input.file(type='file', (change)='processUpload($event)', id='portrait_file')
      td
        table     
          +statblock('ST:', 'st', true, false)
          +statblock('DX:', 'dx', true, false)
          +statblock('IQ:', 'iq', true, false)
          +statblock('HT:', 'ht', true, false)
          +statblock('Will:', 'will', true, false)
          +statblock('Per:', 'per', true, false)
      td
        table     
          +statblock('Lift ST:', 'liftSt', true, false)
          +statblock('Strike ST:', 'strikeSt', true, false)
          +statblock('BM:', 'basicMove', true, false)
          +statblock('BS:', 'basicSpeed', true, false)
          +statblock('FP:', 'fp', true, false)
          +statblock('HP:', 'hp', true, false)
      td
        table
          +statblock('Point Total:', 'cp.cp', false, false)
          +statblock('Stats:', 'cp.stats', false, true)
          +statblock('Advatages:', 'cp.adv', false, true)
          +statblock('Disadvantages:', 'cp.dis', false, true)
          +statblock('Skills:', 'cp.skills', false, true)
          +statblock('Unspent:', 'cp.unspent', false, true)


div(*ngIf='current')
  div: +mainInfo
  div: +mainVariables
  .container
    .traits
      app-trait-list([traits]='current.traits', [category]="'Advantage'", (change)='traitChanged()')
      app-trait-list([traits]='current.traits', [category]="'Disadvantage'", (change)='traitChanged()')
    app-skill-list([skills]='current.skills', (change)='skillChanged()')

      
  

